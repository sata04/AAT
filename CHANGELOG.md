# Changelog

All notable changes to AAT (Acceleration Analysis Tool) will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Changed
- **GUIフレームワークの移行**:
  - PyQt6からPySide6に移行
  - すべてのPyQt6インポートをPySide6に置き換え
  - `pyqtSignal` を `Signal`、`pyqtProperty` を `Property`、`pyqtSlot` を `Slot` に変更
  - ビルドスクリプト（`scripts/build_mac_app.py`）のhidden importsを更新
  - すべてのドキュメント（開発者ガイド、デプロイメントガイド、テストガイド）のコード例を更新
  - `pytest` の `qt_api` 設定を `pyside6` に更新

## [10.0.0] - 2025-11-22

### Added
- **ライトモードとシステムテーマのサポート**:
  - ダークモード（デフォルト）、ライトモード、システムデフォルトの3つのテーマオプションを提供
  - OSのテーマ設定（ライト/ダーク）に合わせて自動的に切り替わる機能を追加
  - ライトモードの配色を「Modern Indigo」テーマに刷新し、視認性を向上
- **モダンなUIコンポーネント**:
  - アニメーション付きのトグルスイッチ（設定ダイアログ）
  - スタイリッシュなドロップダウンメニュー（QComboBox）
  - 全体的なUIの視認性と操作性を向上（フォントサイズ、余白、レイアウトの最適化）

### Changed
- UIテーマ基盤を刷新し、メジャーバージョン 10 としてリリース
- ウィンドウタイトルを "AAT (Acceleration Analysis Tool)" に統一
- `gui/styles.py` を拡張し、テーマ管理を一元化
- 設定ダイアログのチェックボックスをトグルスイッチに置き換え
- メニューバーの「表示」メニューに「テーマ」サブメニューを追加
- 全ドキュメント（README, ユーザーマニュアル, 開発者ガイド等）を最新仕様に合わせて更新
- **データ処理の安定性と柔軟性を向上**:
  - Inner CapsuleまたはDrag Shieldのいずれか片方のデータしか存在しない場合でも、エラーにならずに解析・表示できるよう改善
  - グラフ表示時に利用可能なセンサーデータのみを自動的に判別して表示（`_resolve_sensor_visibility`）

### Fixed
- データ読み込み時の列検出ロジックを改善し、より多様なCSVフォーマットに対応
- フィルタリング処理時のデータ長不整合によるエラーハンドリングを強化
- グラフ描画時のセンサーデータ欠落によるクラッシュを防止

### Technical Changes
- バージョン管理ロジックを `core/version.py` に分離
- パス管理ロジックを `core/paths.py` に分離し、ディレクトリ構造の扱いを改善
- 設定ファイルの保存場所をアプリケーションルートからユーザー設定ディレクトリ（例: `Application Support/AAT`）に移動
- キャッシュシステムの最適化（生データの保存にHDF5を採用し、Pickleのサイズ制限を回避）

## [9.3.0] - 2025-08-09

### Changed
- デフォルト設定でのInner Capsule加速度反転オプション (`invert_inner_acceleration`) を `true` に変更
  - より直感的な加速度データ表示を実現
  - 既存の解析結果との一貫性を向上
- エクスポート機能の設定オプションを追加
  - 図表の幅・高さ設定 (`export_figure_width`, `export_figure_height`)
  - DPI設定 (`export_dpi`)

### Fixed
- デフォルト設定ファイルの一貫性を改善
- 設定値の検証とエラーハンドリングを強化

### Technical Changes
- アプリケーションバージョンを9.2.0から9.3.0に更新
- キャッシュシステムのバージョン管理により、設定変更に伴う自動再計算を実現

## [9.2.0] - 2025-08-08

### Added
- 開発環境セットアップの改善と自動化
- Code quality toolsの統合（Ruff linter/formatter）
- CI/CDパイプライン（GitHub Actions）の追加
- Pre-commitフックによる自動コード品質チェック
- VSCode設定ファイル（推奨拡張機能、設定）
- 包括的なドキュメント（API、ユーザーマニュアル、開発者ガイド）
- コマンドライン引数のサポート（--verbose, -v）
- 環境変数によるデバッグ制御（AAT_DEBUG, AAT_LOG_LEVEL）
- カスタム例外クラスによるエラーハンドリングの改善
- プロジェクト構造の最適化（config/, docs/ディレクトリ）

### Changed
- pyproject.tomlベースのプロジェクト構成に移行
- 依存関係管理をuvパッケージマネージャーに移行
- より厳密なコード品質基準の適用（Ruff設定）
- ロギングシステムの拡張と改善
- キャッシュ検証ロジックの改善
- データ処理パイプラインの最適化
- GUI応答性とエラーメッセージの改善

### Fixed
- macOS環境でのPySide6関連の警告を抑制
- バックグラウンドワーカーのエラーハンドリング強化
- 設定ファイル検証の改善

### Security
- 入力検証の強化
- エラーメッセージの安全な表示

## [9.1.0] - 2025-05-25

### Added
- 出力ディレクトリ管理機能の強化
- エラーハンドリングの改善
- より詳細なログ出力

### Changed
- 同期点検出アルゴリズムの改善により精度が向上
- 時間軸調整ロジックの最適化
- UIレイアウトの細かな改善
- matplotlib互換性の向上（最新バージョン対応）

### Fixed
- 特定のCSVフォーマットで発生していた同期点検出エラー
- グラフ表示の軸ラベルが重なる問題
- キャッシュファイルの破損時のエラーハンドリング

## [9.0.0] - 2025-05-05

### Added
- バックグラウンド処理（QThread）によるUIの応答性向上
- グラフ上でのマウスドラッグによる範囲選択機能
- 選択範囲の詳細統計情報をリアルタイム表示
- 処理進捗をプログレスバーで表示
- キャッシュシステムの導入（pickle + HDF5）

### Changed
- アーキテクチャの大幅な改善（GUI/Core分離）
- データ処理パイプラインの最適化
- メモリ使用量の削減

### Fixed
- 大容量ファイル処理時のメモリリーク
- UIフリーズの問題
- エラー時のアプリケーションクラッシュ

### Security
- ファイルパスのサニタイゼーション強化

## [8.0.0]

### Added
- Inner CapsuleとDrag Shieldの時間軸同期機能を追加
- 加速度閾値に基づく自動同期システムを実装
- 統一された時間軸でのデータ補間機能を追加
- データ同期用の加速度閾値設定を追加
- 同期データの二軸プロット機能を実装
- グラフ出力への"AAT-v8"バージョン識別子を追加

### Changed
- 統一時間軸での補間データエクスポート機能を強化
- テーブルヘッダーの表示を改善
- G-quality解析の進捗表示を強化

## [7.2.0]

### Changed
- 設定ダイアログの拡張と改善
- エクスポートデータの形式を改善
- 複数のキャプセルデータの統合比較機能を強化

## [7.0.0]

### Added
- Inner CapsuleとDrag Shield両方の解析に対応
- G-quality解析用のワーカースレッドを実装
- プログレスバーによる進捗表示機能を追加

## [6.0.0]

### Added
- G-quality解析機能を追加
- マルチスレッド処理を実装
- 進捗表示機能を追加

## [5.4.0]

### Changed
- UI表示の最適化
- グラフ表示機能の改善
- エラー処理の強化

## [5.3.0]

### Changed
- グラフィカルインターフェースの改善
- データ処理の最適化

## [5.2.0]

### Changed
- データセット管理機能の強化
- エラー処理の改善

## [5.0.0]

### Added
- 複数ファイル比較機能を実装
- データセットセレクタを追加
- フルデータ表示モードを追加

## [4.6.0]

### Changed
- 設定管理機能の改善
- エラーハンドリングの強化

## [4.5.0]

### Changed
- ユーザーインターフェースの改善
- データ処理の最適化

## [4.4.0]

### Changed
- 複数ファイル処理の改善
- グラフ表示の最適化

## [4.3.0]

### Changed
- データ処理アルゴリズムの改善
- エラー処理の強化

## [4.2.0]

### Changed
- ファイル処理の安定性向上
- UIの応答性改善

## [4.0.0]

### Added
- 設定ダイアログを追加
- 設定管理システムを実装
- Excelエクスポート機能を追加

## [3.3.0]

### Changed
- ユーザーインターフェースの改善
- ファイル処理の最適化

## [3.2.0]

### Changed
- データ処理の安定性向上
- エラー処理の改善

## [3.0.0]

### Added
- グラフィカルユーザーインターフェース（GUI）を実装
- 基本的な解析機能を追加
- データ可視化機能を実装

## [2.3.0]

### Changed
- ファイル処理の改善
- エラー処理の強化

## [2.2.0]

### Changed
- データ処理機能の安定性向上
- 基本機能の改善

## [2.0.0]

### Added
- 基本的なデータ処理機能を実装
- ファイル処理システムを追加
- 設定ファイルのサポートを追加

## [1.0.0]

### Added
- 初回リリース


詳細な変更内容については、各リリースのGitHubリリースページを参照してください。

[Unreleased]: https://github.com/sata04/AAT/compare/v10.0.0...HEAD
[10.0.0]: https://github.com/sata04/AAT/compare/v9.3.0...v10.0.0
[9.3.0]: https://github.com/sata04/AAT/compare/v9.2.0...v9.3.0
[9.2.0]: https://github.com/sata04/AAT/compare/v9.1.0...v9.2.0
[9.1.0]: https://github.com/sata04/AAT/compare/v9.0.0...v9.1.0
[9.0.0]: https://github.com/sata04/AAT/releases/tag/v9.0.0
