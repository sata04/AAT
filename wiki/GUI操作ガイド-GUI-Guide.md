# GUI操作ガイド - GUI Guide

このページでは、AATのグラフィカルユーザーインターフェース（GUI）の詳細な使い方を説明します。

---

## 🖥️ メインウィンドウの構成

AATのメインウィンドウは、以下のセクションで構成されています:

```
┌─────────────────────────────────────────┐
│ メニューバー                              │
├─────────────────────────────────────────┤
│ ヘッダー（タイトル・バッジ・モード切替）    │
├─────────────────────────────────────────┤
│                                         │
│       グラフ表示エリア                    │
│                                         │
├─────────────────────────────────────────┤
│ 統計情報テーブル                          │
├─────────────────────────────────────────┤
│ ファイル選択・実行ボタン                   │
└─────────────────────────────────────────┘
```

---

## 📋 メニューバー

### ファイル (File)

| メニュー項目 | 機能 | ショートカット |
|-------------|------|---------------|
| **設定** | 設定ダイアログを開き、解析パラメータを変更します | - |
| **終了** | アプリケーションを終了します | Cmd+Q (macOS) / Alt+F4 (Win) |

### 表示 (View)

| メニュー項目 | 機能 | 説明 |
|-------------|------|------|
| **比較モード** | 複数データセットの重ね合わせ表示 | チェックボックスで切替 |
| **全体表示** | フィルタリング（トリミング）なしで全データを表示 | チェックボックスで切替 |
| **G-quality評価モード** | G-quality解析を実行し、結果を表示 | チェックボックスで切替 |
| **テーマ** | UIの外観を変更 (システム/ダーク/ライト) | ラジオボタンで選択 |

### ヘルプ (Help)

| メニュー項目 | 機能 |
|-------------|------|
| **バージョン情報** | アプリケーションのバージョン、ライセンス、クレジットを表示 |

---

## 🎛️ ヘッダーセクション

### タイトルとステータスバッジ

```
AAT (Acceleration Analysis Tool)  [比較モード]  [全体表示]
```

- **◆ 比較モード**: 複数のデータセットを比較表示中（オレンジ色）
- **◇ 全体表示**: フィルタリングを無効化し、全期間を表示中（緑色）

### モード切替スイッチ

ヘッダー右側のトグルスイッチで、表示モードを素早く切り替えられます:

| トグルスイッチ | 機能 | デフォルト |
|-------|------|-----------|
| **比較モード** | ONにすると、読み込んだ複数のファイルを重ねて表示します | OFF |
| **全体表示** | ONにすると、自動フィルタリングを無効化し、全データを表示します | OFF |

---

## 📊 グラフ表示エリア

### 表示内容

- **初期状態**: 「CSVファイルを選択して開始」というメッセージが表示されます。
- **データ読み込み後**: 重力レベルの時間変化グラフが描画されます。
    - **青線**: Inner Capsule
    - **赤線**: Drag Shield

### インタラクティブ操作

#### 範囲選択（ズームイン・統計確認）

1. グラフ上でマウスの左ボタンを押したままドラッグします。
2. 矩形の範囲が選択されます。
3. マウスボタンを離すと、**選択範囲の統計情報ダイアログ**が表示されます。

#### ツールバー操作

グラフ下部（または上部）にMatplotlibのナビゲーションツールバーが表示されます:
- **ホーム**: 初期ビューに戻る
- **パン/ズーム**: グラフを移動・拡大縮小
- **保存**: 現在のグラフ表示を画像として保存

---

## 📋 統計情報テーブル

処理された各ファイルの統計解析結果が一覧表示されます。

### テーブルの列定義

| 列名 (英語) | 説明 |
|------|------|
| **File Name** | 処理されたCSVファイルの名称 |
| **Inner Capsule: Start Time...** | Inner側の「最小標準偏差ウィンドウ」が開始する時刻 (s) |
| **Inner Capsule: Mean G-Level...** | Inner側の「最小標準偏差ウィンドウ」内の平均重力レベル (G) |
| **Inner Capsule: SD...** | Inner側の「最小標準偏差ウィンドウ」内の標準偏差 (G) |
| **Drag Shield: Start Time...** | Drag側の「最小標準偏差ウィンドウ」が開始する時刻 (s) |
| **Drag Shield: Mean G-Level...** | Drag側の「最小標準偏差ウィンドウ」内の平均重力レベル (G) |
| **Drag Shield: SD...** | Drag側の「最小標準偏差ウィンドウ」内の標準偏差 (G) |
| **Processing Time** | データの読み込みから解析完了までにかかった時間 (s) |

### テーブル操作

- **ソート**: 列ヘッダーをクリックすると、その列を基準に昇順/降順で並べ替えます。
- **行選択**: 行をクリックするとハイライトされます（グラフ上の対応するデータ強調は今後の実装予定）。

---

## 🔘 ボタンセクション

### CSVファイルを選択

- **機能**: ファイル選択ダイアログを開き、CSVファイルを読み込む
- **複数選択**: Ctrl/Cmdキーを押しながら複数ファイルを選択可能
- **キーボードショートカット**: なし

### G-quality評価モード

- **機能**: 現在読み込まれているデータに対してG-quality評価を実行
- **有効条件**: データが読み込まれている場合のみ有効
- **進捗表示**: 実行中はプログレスバーが表示

### キャッシュクリア

- **機能**: すべてのキャッシュファイルを削除
- **確認ダイアログ**: 削除前に確認ダイアログが表示
- **影響**: 次回読み込み時にデータが再計算される

---

## ⚙️ 設定ダイアログ

メニューバー「ファイル」→「設定」で開きます。

### 基本設定

| 設定項目 | 説明 | デフォルト値 | 単位 |
|---------|------|-------------|------|
| **サンプリングレート** | データの周波数 | 1000 | Hz |
| **重力定数** | 基準となる重力加速度 | 9.797578 | m/s² |
| **加速度閾値** | 同期点検出の閾値 | 5.0 | m/s² |
| **ウィンドウサイズ** | 統計計算の時間窓 | 0.1 | 秒 |
| **終了重力レベル** | フィルタリング閾値 | 8.0 | G |
| **開始点からの最小秒数** | 終了点探索を始めるまでの待ち時間 | 0.7 | 秒 |

### 機能設定（トグルスイッチ）

| 設定項目 | 説明 | デフォルト |
|---------|------|-----------|
| **キャッシュを使用** | 処理済みデータの再利用 | ON |
| **G-quality自動計算** | ファイル読み込み時に自動評価 | ON |
| **Inner加速度を反転** | Inner Capsuleの加速度の符号を反転 | ON |
| **Innerセンサーを使用** | Inner データを読み込み・処理 | ON |
| **Dragセンサーを使用** | Drag データを読み込み・処理 | ON |

### エクスポート設定

| 設定項目 | 説明 | デフォルト値 |
|---------|------|-------------|
| **図の幅** | エクスポート時のグラフ幅 | 10.6インチ |
| **図の高さ** | エクスポート時のグラフ高さ | 3.4インチ |
| **DPI** | グラフの解像度 | 300 |

### ボタン

- **OK**: 設定を保存してダイアログを閉じる
- **キャンセル**: 変更を破棄してダイアログを閉じる

---

## 🎨 テーマ設定

### テーマの種類

#### 1. システムデフォルト（推奨）

- OSの設定（ライト/ダーク）に自動的に追従
- macOSの外観設定を変更すると即座に反映

#### 2. ダークモード

- 背景: 暗いグレー
- テキスト: 白
- グラフ背景: 暗い配色
- 目に優しく、長時間の作業に適している

#### 3. ライトモード

- 背景: 白
- テキスト: 黒
- グラフ背景: 明るい配色
- 印刷物との整合性が高い

### テーマの切替方法

1. メニューバー「表示」→「テーマ」を選択
2. 以下から選択:
   - **システムデフォルト**
   - **ダークモード**
   - **ライトモード**
3. 即座に反映されます（再起動不要）

---

## 💬 ダイアログとメッセージ

### 統計情報ダイアログ

範囲選択後に表示されるダイアログ:

```
選択範囲の統計情報

Inner Capsule:
  平均値: -0.0023 G
  絶対値の平均: 0.0023 G
  標準偏差: 0.0012 G
  最小値: -0.0045 G
  最大値: -0.0001 G
  範囲: 0.0044 G
  データ数: 523

Drag Shield:
  ...

[OK]
```

### 列選択ダイアログ

CSVの列を自動検出できない場合に表示:

```
列を選択してください

時間列:         [ドロップダウン ▼]
Inner Capsule:  [ドロップダウン ▼]
Drag Shield:    [ドロップダウン ▼]

[OK]  [キャンセル]
```

### 確認ダイアログ

キャッシュクリアなどの操作前に表示:

```
確認

すべてのキャッシュを削除しますか？
この操作は元に戻せません。

[はい]  [いいえ]
```

### バージョン情報ダイアログ

アプリケーション情報を表示:

```
AAT (Acceleration Analysis Tool)

バージョン: 10.0.0
ライセンス: Apache License 2.0

Made with ❤️ for scientific research

[OK]
```

---

## 🔄 プログレスバー

### 表示タイミング

- データ処理中
- G-quality評価実行中
- 大量のファイルを処理中

### プログレスバーの情報

- **進捗率**: 0%〜100%のパーセンテージ表示
- **現在の処理**: 「データ処理中...」「G-quality評価中...」などのメッセージ
- **キャンセルボタン**: 長時間処理はキャンセル可能（実装状況により異なる）

---

## ⌨️ キーボードショートカット

| ショートカット | 機能 | プラットフォーム |
|--------------|------|-----------------|
| **Cmd+Q** | アプリケーション終了 | macOS |
| **Alt+F4** | アプリケーション終了 | Windows/Linux |

※その他のショートカットは現在実装されていません

---

## 🛠️ カスタマイズ

### ウィンドウサイズ

- ウィンドウは自由にリサイズ可能
- 最小サイズ: 800 × 600
- グラフエリアは自動的にリサイズに追従

### フォントサイズ

現在、UIからフォントサイズを変更する機能はありません。OSのアクセシビリティ設定を使用してください。

---

## 💡 使用上のヒント

### 効率的なワークフロー

1. **設定を先に調整**: データ読み込み前に設定を確認
2. **比較モードを活用**: 複数の実験結果を一度に評価
3. **G-quality自動計算をON**: 読み込み時に自動評価で手間を削減
4. **キャッシュを有効化**: 再処理を高速化

### トラブル回避

- **キャッシュクリア**: 設定変更後もキャッシュが使われる場合、手動でクリア
- **テーマがおかしい**: システムデフォルトに一度戻してから再設定
- **グラフが表示されない**: ウィンドウを最大化してみる

---

## ❓ よくある質問

### Q: ボタンがクリックできない（グレーアウト）

**A**: データが読み込まれていない可能性があります。まずCSVファイルを読み込んでください。

### Q: 統計ダイアログが表示されない

**A**: 範囲選択が小さすぎる可能性があります。より広い範囲をドラッグしてください。

### Q: テーマが変わらない

**A**: 一度アプリケーションを再起動してみてください（通常は不要ですが、稀に発生）。

---

## 🚀 次のステップ

- **[[使い方-Usage]]** - 基本的な操作フローを確認
- **[[設定-Configuration]]** - 設定パラメータの詳細
- **[[グラフと可視化-Graphs-and-Visualization]]** - グラフ機能の詳細
