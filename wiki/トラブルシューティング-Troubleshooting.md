# トラブルシューティング - Troubleshooting

このページでは、AATの使用中に発生する可能性のある問題と解決方法を説明します。

> [!NOTE]
> より詳細な情報は [docs/user-manual.md](../docs/user-manual.md) もご覧ください。

---

## 🚫 アプリケーション起動の問題

### Q: アプリケーションが起動しない

**症状**: `python main.py`を実行してもウィンドウが表示されない

**解決法**:

1. **Pythonバージョンの確認**
   ```bash
   python --version
   # 3.10以上が必要
   ```

2. **依存関係の再インストール**
   ```bash
   uv pip install -e ".[dev]" --force-reinstall
   ```

3. **ログの確認**
   ```bash
   AAT_DEBUG=1 uv run python main.py
   ```

### Q: macOSで「開発元を確認できません」エラー

**症状**: macOSアプリバンドルをダブルクリックすると拒否される

**解決法**:

1. システム環境設定 → セキュリティとプライバシー
2. 「このまま開く」をクリック

または:

```bash
xattr -cr /path/to/AAT.app
```

---

## 📁 ファイル読み込みの問題

### Q: CSVファイルが読み込めない

**症状**: 「ファイルの読み込みに失敗しました」エラー

**解決法**:

1. **エンコーディングの確認**
   - UTF-8またはShift-JIS (CP932)で保存されているか確認
   - Excel で保存した場合、CSVのエンコーディングに注意

2. **列名の確認**
   - 時間列と加速度列が存在するか
   - 列選択ダイアログで手動選択を試す

3. **ファイルフォーマットの確認**
   ```csv
   Time,Inner_Accel,Drag_Accel
   0.000,-0.05,0.02
   0.001,-0.04,0.03
   ```

### Q: 列選択ダイアログで列が表示されない

**症状**: ドロップダウンに列が表示されない

**解決法**:

- CSVファイルの1行目にヘッダーがあるか確認
- 区切り文字がカンマ`,`であるか確認

---

## 📊 グラフ表示の問題

### Q: グラフが表示されない

**症状**: データは読み込めたが、グラフエリアが空白

**解決法**:

1. **データの確認**
   - データに有効な数値が含まれているか
   - NANやINFが多すぎないか

2. **ウィンドウサイズの確認**
   - ウィンドウを最大化してみる
   - ウィンドウをリサイズしてみる

3. **再プロット**
   - 別のCSVを読み込んでから、再度元のCSVを読み込む

### Q: 日本語フォントが文字化けする

**症状**: グラフの軸ラベルが□□□で表示される

**解決法**:

**macOS**:
```bash
# Hiragino Sansが標準で使用されます（通常問題なし）
```

**Windows**:
```bash
# Yu Gothicが使用されます
# フォントキャッシュのクリア:
del %USERPROFILE%\.matplotlib\fontlist-*.json
```

**Linux**:
```bash
# Noto Sans CJKをインストール
sudo apt-get install fonts-noto-cjk
```

---

## ⚙️ 処理・計算の問題

### Q: 処理が非常に遅い

**症状**: ファイル読み込みに数分以上かかる

**解決法**:

1. **キャッシュを有効化**
   - 設定で「キャッシュを使用」をONにする

2. **ファイルサイズを確認**
   - 数百MB以上のファイルは処理に時間がかかる
   - 必要に応じてファイルを分割

3. **バックグラウンドアプリを終了**
   - メモリを多く使用する他のアプリを終了

### Q: G-quality評価が完了しない

**症状**: 進捗バーが途中で止まる

**解決法**:

1. **データサイズの確認**
   - 非常に大きいデータセットの場合、時間がかかる
   - 最大1分程度待ってみる

2. **ログの確認**
   ```bash
   AAT_LOG_LEVEL=DEBUG uv run python main.py
   # 進行状況や警告がコンソールに出力されます
   ```

3. **アプリケーションの再起動**

---

## 💾 ファイル保存の問題

### Q: Excelファイルが生成されない

**症状**: データ処理は完了するが、Excelファイルがない

**解決法**:

1. **保存先の確認**
   ```
   <元のCSVファイルのディレクトリ>/results_AAT/
   ```

2. **権限の確認**
   - ディレクトリへの書き込み権限があるか確認

3. **ログの確認**
   - `AAT_LOG_LEVEL=DEBUG uv run python main.py` でコンソール出力を確認

### Q: グラフ画像が保存されない

**症状**: Excel ファイルは生成されるが、PNGがない

**解決法**:

1. **出力ディレクトリの確認**
   ```
   <元のCSVファイルのディレクトリ>/results_AAT/graphs/
   ```

2. **Matplotlibの再インストール**
   ```bash
   uv pip install --upgrade matplotlib
   ```

---

## 🔧 設定の問題

### Q: 設定が保存されない

**症状**: 設定を変更してもOKしても、次回起動時に元に戻る

**解決法**:

1. **設定ファイルのパス確認**
   ```bash
   # macOS
   ls -la ~/Library/Application\ Support/AAT/

   # Linux
   ls -la ~/.config/AAT/

   # Windows
   dir %APPDATA%\AAT\
   ```

2. **書き込み権限の確認**
   - ディレクトリへの書き込み権限を確認

3. **手動で設定ファイルを編集**
   - `config.json`を直接編集して保存

### Q: 設定がおかしくなった

**症状**: 設定を変更したら動作がおかしくなった

**解決法**:

1. **設定ファイルを削除して再生成**
   ```bash
   # macOS
   rm ~/Library/Application\ Support/AAT/config.json

   # 次回起動時に自動的にデフォルト設定がコピーされる
   ```

---

## 🖥️ macOS特有の問題

### Q: 「ウィンドウ移動」の警告メッセージ

**症状**: ターミナルに警告メッセージが表示される

**解決法**:

- これは無害な警告です
- AATは自動的にこれらの警告を抑制します
- 機能には影響しません

### Q: アプリが突然終了する

**症状**: macOSアプリバンドルが予期せず終了

**解決法**:

1. **デバッグモードで起動**
   ```bash
   AAT_DEBUG=1 /path/to/AAT.app/Contents/MacOS/AAT
   ```

2. **クラッシュログの確認**
   ```bash
   ~/Library/Logs/DiagnosticReports/
   ```

---

## 🐛 キャッシュの問題

### Q: 設定を変更してもデータが再計算されない

**症状**: キャッシュが更新されていない

**解決法**:

1. **キャッシュをクリア**
   - 「キャッシュクリア」ボタンをクリック

2. **手動でキャッシュを削除**
   ```bash
   rm -rf results_AAT/cache/
   ```

3. **キャッシュを無効化**
   - 設定で「キャッシュを使用」をOFF

---

## 📞 サポート

### ログの取得

トラブル報告時はターミナル出力を添付してください:

```bash
AAT_LOG_LEVEL=DEBUG uv run python main.py
```
必要に応じて `AAT_DEBUG=1` を併用するとデバッグログが増えます。

### バグ報告

上記で解決しない場合:

1. [GitHub Issues](https://github.com/sata04/AAT/issues) でバグ報告
2. 以下の情報を含めてください:
   - OS とバージョン
   - AATのバージョン
   - エラーメッセージ
   - ターミナル出力（`AAT_LOG_LEVEL=DEBUG` を付けて実行したもの）
   - 再現手順

---

## 🚀 次のステップ

- **[[使い方-Usage]]** - 基本的な使い方を再確認
- **[[設定-Configuration]]** - 設定の詳細
- **[[開発者ガイド-Developer-Guide]]** - デバッグ方法
