# AAT (Acceleration Analysis Tool)

## 概要
AATは微小重力環境下での実験データを分析するためのツールです。Inner CapsuleとDrag Shieldの加速度データを読み込み、重力レベルを計算・可視化し、統計的分析を行うことができます。

## 主な機能
- CSVファイルからの加速度データ読み込み
- 重力レベルの計算と可視化
- 同期点を基準にした時間の調整
- データのフィルタリング
- 最小標準偏差ウィンドウの検出と統計分析
- G-quality評価モードによる詳細な重力レベル分析
- 複数データの比較分析
- 結果のExcelファイル出力とグラフの保存

## システム要件
- Python 3.7以上
- 必要なライブラリ:
  - PyQt6
  - matplotlib
  - numpy
  - pandas
  - openpyxl

## インストール方法
1. リポジトリをクローン:
   ```
   git clone https://github.com/sota04/AAT.git
   ```

2. 必要なライブラリをインストール:
   ```
   pip install -r requirements.txt
   ```

## 使用方法
1. アプリケーションの起動:
   ```
   python main.py
   ```

2. CSVファイルの選択:
   - 「CSVファイルを選択」ボタンをクリックして、分析したいデータファイルを選択します。
   - 複数のファイルを選択することも可能です。
   - CSVファイル内の列が自動検出されない場合は、列選択ダイアログが表示されます。

3. データの分析:
   - 選択されたファイルのデータが自動的に処理され、グラフが表示されます。
   - グラフには、Inner CapsuleとDrag Shieldの重力レベルが時間の関数として表示されます。
   - 下部のテーブルには統計情報が表示されます。

4. 表示モードの切替:
   - 「全体を表示」ボタンで、フィルタリング前の全データを表示できます。
   - 「複数ファイルを比較」ボタンで、複数のファイルのデータを同時に比較できます。
   - データセット選択コンボボックスで、個別のファイル表示に切り替えることができます。

5. G-quality分析:
   - 「G-quality評価モード」ボタンを押すと、異なるウィンドウサイズでの重力レベルの変動を詳細に分析します。
   - この分析により、様々なウィンドウサイズにおける最小標準偏差区間の平均重力レベルとその標準偏差を確認できます。
   - G-quality分析の結果はグラフとExcelファイルの両方に保存されます。

6. 設定変更:
   - 「設定」ボタンをクリックして、分析パラメータをカスタマイズできます。

## 設定パラメータ
設定ダイアログでは以下のパラメータを調整できます：
- データ列名（時間、加速度）の指定
- サンプリングレート (Hz)
- 重力定数 (m/s²)
- グラフのY軸範囲
- 加速度同期閾値 (m/s²)
- 終了重力レベル (G)
- 解析ウィンドウサイズ (秒)
- G-quality解析パラメータ:
  - 開始ウィンドウサイズ (秒)
  - 終了ウィンドウサイズ (秒) 
  - ステップサイズ (秒)
- 終了点の開始点からの最小秒数 (秒)

## ファイル構成
- `main.py`: アプリケーションのエントリーポイント
- `config.json`: 設定ファイル
- `core/`: コア機能モジュール
  - `data_processor.py`: データ処理機能
  - `statistics.py`: 統計分析機能
  - `export.py`: データエクスポート機能
  - `config.py`: 設定管理機能
  - `logger.py`: ログ機能
- `gui/`: グラフィカルユーザーインターフェース
  - `main_window.py`: メインウィンドウ実装
  - `settings_dialog.py`: 設定ダイアログ
  - `column_selector_dialog.py`: 列選択ダイアログ
  - `workers.py`: バックグラウンド処理用ワーカークラス

## 出力ファイルとディレクトリ構造
処理結果は元のCSVファイルと同じディレクトリの `results_AAT` フォルダ内に保存されます：

```
<元のCSVファイルのディレクトリ>/
└── results_AAT/
    ├── <ファイル名>.xlsx  # 重力レベルデータと統計情報
    └── graphs/
        ├── <ファイル名>_gl.png  # 重力レベルグラフ
        └── <ファイル名>_gq.png  # G-quality分析グラフ（G-quality評価モード実行時）
```

Excelファイルには以下のシートが含まれます：
- `Gravity Level Data`: 時間と重力レベルのデータ
- `Gravity Level Statistics`: 統計情報
- `G-quality Analysis`: G-quality分析結果（G-quality評価モード実行時）

## ライセンス
このソフトウェアはApache License 2.0の下で公開されています。詳細はLICENSE.mdファイルを参照してください。
