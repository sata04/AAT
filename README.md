# AAT (Acceleration Analysis Tool)

## 概要
AATは微小重力環境下での実験データを分析するためのツールです。Inner CapsuleとDrag Shieldの加速度データを読み込み、重力レベルを計算・可視化し、統計的分析を行うことができます。

## 主な機能
- CSVファイルからの加速度データ読み込み
- 重力レベルの計算と可視化
- 同期点を基準にした時間の調整
- データのフィルタリング
- 最小標準偏差ウィンドウの検出と統計分析
- G-quality評価モードによる詳細な重力レベル分析
- 複数データの比較分析
- 結果のExcelファイル出力とグラフの保存

## システム要件
- Python 3.7以上
- 必要なライブラリ:
  - PyQt6
  - matplotlib
  - numpy
  - pandas
  - openpyxl

## インストール方法
1. リポジトリをクローン:
   ```
   git clone https://github.com/sota04/AAT.git
   ```

2. 必要なライブラリをインストール:
   ```
+  pip install -r requirements.txt
   ```

## 使用方法
1. アプリケーションの起動:
   ```
   python main.py
   ```

2. CSVファイルの選択:
   - 「CSVファイルを選択」ボタンをクリックして、分析したいデータファイルを選択します。
   - 複数のファイルを選択することも可能です。

3. データの分析:
   - 選択されたファイルのデータが自動的に処理され、グラフが表示されます。
   - グラフには、Inner CapsuleとDrag Shieldの重力レベルが時間の関数として表示されます。

4. 表示モードの切替:
   - 「全体を表示」ボタンで、フィルタリング前の全データを表示できます。
   - 「複数ファイルを比較」ボタンで、複数のファイルのデータを同時に比較できます。

5. G-quality分析:
   - 「G-quality評価モード」ボタンを押すと、異なるウィンドウサイズでの重力レベルの変動を詳細に分析できます。
   - この分析により、安定した微小重力環境の時間窓を特定できます。

6. 設定変更:
   - 「設定」ボタンをクリックして、分析パラメータをカスタマイズできます。

## 設定パラメータ
設定ダイアログでは以下のパラメータを調整できます：
- データ列名（時間、加速度）の指定
- サンプリングレート
- 重力定数
- グラフのY軸範囲
- 加速度閾値
- 終了重力レベル
- 解析ウィンドウサイズ
- G-quality分析パラメータ

## ファイル構成
- `main.py`: アプリケーションのエントリーポイント
- `config.json`: 設定ファイル
- `core/`: コア機能モジュール
  - `data_processor.py`: データ処理機能
  - `statistics.py`: 統計分析機能
  - `export.py`: データエクスポート機能
  - `config.py`: 設定管理機能
- `gui/`: グラフィカルユーザーインターフェース
  - `main_window.py`: メインウィンドウ実装
  - `settings_dialog.py`: 設定ダイアログ
  - `workers.py`: バックグラウンド処理用ワーカークラス

## 出力ファイル
分析結果は以下の形式で保存されます：
- 重力レベルグラフ: `{ファイル名}_gravity_level_graph.png`
- 統計データおよび結果を含むExcelファイル: `{ファイル名}_processed.xlsx`  # 修正: コードに合わせて
- G-quality分析結果: `{ファイル名}_g_quality_analysis.png`

## ライセンス
- このソフトウェアはApache License 2.0の下で公開されています。詳細はLICENSE.mdファイルを参照してください。
